# `offline-plugin` for webpack

This plugin is intended to provide basic offline(-first?) experience for **webpack** projects. It uses **ServiceWorker** and **AppCache** as a fallback under the hood. Simply include this plugin in your ``webpack.config`` and your project will became offline ready by caching all (or some) output assets.

## Install

`npm install offline-plugin [--save-dev]`

## Setup

```js
// webpack.config.js

var OfflinePlugin = require('offline-plugin');

module.exports = {
  // ...

  plugins: [
    // ... other plugins

    new OfflinePlugin({
      // options here
    })
  ]
  // ...
}

```

## Options

All options are optional and `offline-plugin` could be used without them. See full list of default options [here](https://github.com/NekR/offline-plugin/blob/master/src/index.js#L9)

* **caches**: `'all' | Object`. Tells to the plugin what to cache and how. Default: `'all'`.
  * `all`: means that everything (all the webpack output assets) will be cached in `main` cache.
  * `Object`: Object with 3 possible _Array<string>_ sections (properties). All sections are optional and default to `[':rest:']`. `:rest:` is a special keyword which means "_all the rest unused (uncahed) assets_". **Any section can contain any assets, not only those which are generated by the _webpack_ build. However, when external assets is included you will receive warning about it**.
    * `main` cache. Assets listed in this section are cached first (via `install` event in `ServiceWorker`) and if caching of this section fails -- nor assets are cached at all. Hence, it should contain minimal set of assets, for example `['index.html', 'main.js']`.
    * `additional` cache. Assets in this section are loaded after `main` section is successfully loaded.
      * In `ServiceWorker` this section is loaded in `activate` event. If any of assets fails to download, then nothing is cached from the `additional` section and all the assets are moved to the `optional` section. If **current update strategy** is `changed`, then only failed to download assets are moved to the `optional` section, all other are successfully cached.
      * In `AppCache` runtime simply download another `.appcache` file which contains assets from `additional` section. If some of the assets fails to download, then entire `additional` cache is not stored.
    * `optional` cache. This sections **is only supported** by `ServiceWorker`. As you may guess from its name, assets are cached only when they are fetched from the server. `ServiceWorker` won't download them ahead of time.
* **scope**: `string`. Scope of the project, for example `'/m/'` or `'/admin/'`. Default: `'/'`.
* **updateStrategy**: `'all' | 'hash' | 'changed'`. Cache update strategy. Default: `'all'`.
  * `all` strategy uses `version` passed to options as a cache tag. When version changes, old version cache is removed and new files are downloaded. Of course if files has same name were not changed (304 status returned), then probably browser won't download them again and will just update cache.
  * `hash` strategy is basically the same as `all` strategy, but uses _webpack unique compilation hash_ as a tag.
  * `changed` strategy is more advanced than `all` or `hash`. To work properly it requires output assets to have unique names between compilations, e.g. _file's unique hash_ in its name. **With this strategy enabled, `index.html` file (or other files without dynamic name) should be placed in `main` section of the cache, otherwise they won't be revalidated**.
    * For `ServiceWorker` this means that only new files will be downloaded and missing files deleted from the cache.
    * For `AppCache` it's basically same as previous strategies since `AppCache` revalidates all the assets. 304 HTTP status rule of course still works.